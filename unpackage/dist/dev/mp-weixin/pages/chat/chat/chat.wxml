<view class="page"><free-nav-bar vue-id="412038b5-1" showBack="{{true}}" title="{{detail.name}}" noreadnum="{{0}}" bind:__l="__l" vue-slots="{{['right']}}"><view slot="right"><free-icon-button vue-id="{{('412038b5-2')+','+('412038b5-1')}}" icon="" data-event-opts="{{[['^click',[['openChatSet']]]]}}" bind:click="__e" bind:__l="__l"></free-icon-button></view></free-nav-bar><scroll-view class="position-fixed left-0 right-0" style="{{'box-sizing:border-box;'+(chatBodyBottom)}}" scroll-y="{{true}}" scroll-into-view="{{scrollintoView}}" data-event-opts="{{[['tap',[['clickPage',['$event']]]]]}}" bindtap="__e"><block wx:for="{{list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view id="{{'chatItem_'+index}}"><free-chat-item class="vue-ref-in-for" vue-id="{{'412038b5-3-'+index}}" shownickname="{{currentChatItem.shownickname}}" pretime="{{index>0?list[index-1].create_time:''}}" item="{{item}}" index="{{index}}" data-ref="chatItem" data-event-opts="{{[['^preview',[['previewImage']]],['^long',[['long']]]]}}" bind:preview="__e" bind:long="__e" bind:__l="__l"></free-chat-item></view></block><view class="p-1"></view></scroll-view><view class="position-fixed bg-chat left-0 right-0 border-light-secondary border-top" style="{{('bottom:'+KeyboardHeight+'px;')}}"><view class="flex align-center" style="width:100vw;height:105rpx;"><view class="flex-shrink"><block wx:if="{{mode==='audio'}}"><free-icon-button vue-id="412038b5-4" iconfontSize="font-max" icon="" data-event-opts="{{[['^click',[['changeVoiceOrText']]]]}}" bind:click="__e" bind:__l="__l"></free-icon-button></block><block wx:else><free-icon-button vue-id="412038b5-5" iconfontSize="font-max" icon="" data-event-opts="{{[['^click',[['changeVoiceOrText']]]]}}" bind:click="__e" bind:__l="__l"></free-icon-button></block></view><view class="flex-1"><block wx:if="{{mode==='audio'}}"><view data-event-opts="{{[['touchstart',[['voiceTouchStart',['$event']]]],['touchend',[['voiceTouchEnd',['$event']]]],['touchcancel',[['voiceTouchCancel',['$event']]]],['touchmove',[['voiceTouchMove',['$event']]]]]}}" class="{{['rounded','flex','align-center','justify-center',isRecording?'bg-light':'bg-white']}}" style="height:75rpx;" bindtouchstart="__e" bindtouchend="__e" bindtouchcancel="__e" bindtouchmove="__e"><text class="font">{{isRecording?'松开 结束':'按住 说话'}}</text></view></block><block wx:else><textarea class="bg-white rounded mr-0 p-1 font-md" style="width:auto;height:75rpx;" adjust-position="{{false}}" fixed="{{true}}" data-event-opts="{{[['focus',[['focus',['$event']]]],['blur',[['blur',['$event']]]],['input',[['__set_model',['','text','$event',[]]]]]]}}" value="{{text}}" bindfocus="__e" bindblur="__e" bindinput="__e"></textarea></block></view><view class="flex-shrink"><free-icon-button vue-id="412038b5-6" iconfontSize="font-max" icon="" data-event-opts="{{[['^click',[['openActionOrEmoticon',['emoticon']]]]]}}" bind:click="__e" bind:__l="__l"></free-icon-button></view><block wx:if="{{text.length===0}}"><view class="flex-shrink"><free-icon-button vue-id="412038b5-7" iconfontSize="font-max" icon="" data-event-opts="{{[['^click',[['openActionOrEmoticon',['action']]]]]}}" bind:click="__e" bind:__l="__l"></free-icon-button></view></block><block wx:else><view class="flex-shrink"><free-main-button vue-id="412038b5-8" name="发送" data-event-opts="{{[['^click',[['send',['text']]]]]}}" bind:click="__e" bind:__l="__l"></free-main-button></view></block></view><block wx:if="{{mode==='emoticon'||mode==='action'}}"><view class="border-top  border-light-secondary" style="height:650rpx;background-color:#f7f7f7;"><swiper style="height:630rpx;" indicator-dots="{{emoticonOrActionList.length>1}}"><block wx:for="{{emoticonOrActionList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><swiper-item class="row"><block wx:for="{{item}}" wx:for-item="item2" wx:for-index="index2" wx:key="index2"><view data-event-opts="{{[['tap',[['actionEvent',['$0'],[[['emoticonOrActionList','',index],['','',index2]]]]]]]}}" class="flex flex-column justify-center align-center col-3" style="height:255rpx;" bindtap="__e"><image style="width:100rpx;height:100rpx;" src="{{item2.icon}}" mode="widthFix"></image><text class="font-sm text-light-muted mt-2">{{item2.name}}</text></view></block></swiper-item></block></swiper></view></block></view><free-popup class="vue-ref" vue-id="412038b5-9" tabbarHeight="{{105}}" bodyWidth="{{240}}" bodyHeight="{{500}}" data-ref="extend" bind:__l="__l" vue-slots="{{['default']}}"><view class="flex flex-column" style="{{'width:240rpx;'+(getMenusStyle)}}"><block wx:for="{{menusList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="flex-1 flex align-center" hover-stay-time="50" hover-start-time="0" hover-class="bg-hover-light" data-event-opts="{{[['tap',[['clickEvent',['$0'],[[['menusList','',index,'event']]]]]]]}}" bindtap="__e"><text class="font-md  pl-3">{{item.name}}</text></view></block></view></free-popup><block wx:if="{{isRecording}}"><view class="position-fixed top-0 left-0 right-0 flex justify-center align-center" style="bottom:105rpx;"><view class="rounded-2 flex flex-column align-center justify-center" style="width:360rpx;height:360rpx;background-color:rgba(0,0,0,0.5);"><image style="width:150rpx;height:150rpx;" src="/static/audio/recording.gif"></image><text class="font text-white">{{unRecord?'松开手指，取消发送':'手指上滑，取消发送'}}</text><text class="font-md text-white mt-3">{{RecordTime+"s"}}</text></view></view></block></view>